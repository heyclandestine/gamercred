<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gamer Cred Companion</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    .loading-spinner {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      color: #666;
      font-size: 0.9em;
    }
    .loading-spinner i {
      margin-right: 8px;
    }
    .loading-placeholder {
      display: flex;
      align-items: center;
      padding: 10px;
      color: #666;
      font-size: 0.9em;
      border-bottom: 1px solid #eee;
    }
    .loading-placeholder i {
      margin-right: 8px;
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="nav-left">
      <a href="index.html" class="site-title nav-home-btn">Gamer Cred</a>
    </div>
    <div class="nav-center">
      <input type="text" class="search-bar" placeholder="Search players, games...">
    </div>
    <div class="nav-right">
      <button class="discord-login"><i class="fab fa-discord"></i> Login with Discord</button>
    </div>
  </nav>
  <main class="main-grid">
    <section class="leaderboard card leaderboard-modern">
      <h2><i class="fas fa-trophy"></i> Leaderboard</h2>
      <div class="leaderboard-tabs">
        <button class="tab-btn active" data-tab="weekly">Weekly</button>
        <button class="tab-btn" data-tab="monthly">Monthly</button>
        <button class="tab-btn" data-tab="alltime">All-Time</button>
      </div>
      <div class="tab-content" id="weekly">
        <ol>
          <li><span class="rank">1</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/1.jpg" alt="PlayerOne"> <a class="user-link" href="user.html?user=170327552525729792">PlayerOne</a> <span class="score">400 pts</span></li>
          <li><span class="rank">2</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/2.jpg" alt="PlayerTwo"> <a class="user-link" href="user.html?user=170327552525729793">PlayerTwo</a> <span class="score">390 pts</span></li>
          <li><span class="rank">3</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/3.jpg" alt="PlayerThree"> <a class="user-link" href="user.html?user=170327552525729794">PlayerThree</a> <span class="score">370 pts</span></li>
          <li><span class="rank">4</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/4.jpg" alt="PlayerFour"> <a class="user-link" href="user.html?user=170327552525729795">PlayerFour</a> <span class="score">350 pts</span></li>
          <li><span class="rank">5</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/5.jpg" alt="PlayerFive"> <a class="user-link" href="user.html?user=170327552525729796">PlayerFive</a> <span class="score">340 pts</span></li>
        </ol>
      </div>
      <div class="tab-content" id="monthly" style="display:none;">
        <ol>
          <li><span class="rank">1</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/1.jpg" alt="PlayerOne"> <a class="user-link" href="user.html?user=170327552525729792">PlayerOne</a> <span class="score">1,800 pts</span></li>
          <li><span class="rank">2</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/2.jpg" alt="PlayerTwo"> <a class="user-link" href="user.html?user=170327552525729793">PlayerTwo</a> <span class="score">1,700 pts</span></li>
          <li><span class="rank">3</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/3.jpg" alt="PlayerThree"> <a class="user-link" href="user.html?user=170327552525729794">PlayerThree</a> <span class="score">1,600 pts</span></li>
          <li><span class="rank">4</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/4.jpg" alt="PlayerFour"> <a class="user-link" href="user.html?user=170327552525729795">PlayerFour</a> <span class="score">1,550 pts</span></li>
          <li><span class="rank">5</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/5.jpg" alt="PlayerFive"> <a class="user-link" href="user.html?user=170327552525729796">PlayerFive</a> <span class="score">1,500 pts</span></li>
        </ol>
      </div>
      <div class="tab-content" id="alltime" style="display:none;">
        <ol>
          <li><span class="rank">1</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/1.jpg" alt="PlayerOne"> <a class="user-link" href="user.html?user=170327552525729792">PlayerOne</a> <span class="score">9,000 pts</span></li>
          <li><span class="rank">2</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/2.jpg" alt="PlayerTwo"> <a class="user-link" href="user.html?user=170327552525729793">PlayerTwo</a> <span class="score">8,500 pts</span></li>
          <li><span class="rank">3</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/3.jpg" alt="PlayerThree"> <a class="user-link" href="user.html?user=170327552525729794">PlayerThree</a> <span class="score">8,000 pts</span></li>
          <li><span class="rank">4</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/4.jpg" alt="PlayerFour"> <a class="user-link" href="user.html?user=170327552525729795">PlayerFour</a> <span class="score">7,800 pts</span></li>
          <li><span class="rank">5</span> <img class="avatar" src="https://randomuser.me/api/portraits/men/5.jpg" alt="PlayerFive"> <a class="user-link" href="user.html?user=170327552525729796">PlayerFive</a> <span class="score">7,700 pts</span></li>
        </ol>
      </div>
    </section>
    <section class="most-popular card">
      <h2><i class="fas fa-fire"></i> Most Popular</h2>
      <div class="popular-tabs">
        <button class="tab-btn active" data-tab="popular-weekly">Weekly</button>
        <button class="tab-btn" data-tab="popular-monthly">Monthly</button>
        <button class="tab-btn" data-tab="popular-alltime">All-Time</button>
      </div>
      <div class="tab-content" id="popular-weekly">
        <ol class="popular-games-list">
          <li><span class="rank">1</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/27471-144x192.jpg" alt="Stardew Valley"> <a class="game-link" href="game.html?game=StardewValley">Stardew Valley</a> <span class="hours">80 hrs</span></li>
          <li><span class="rank">2</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/516575-144x192.jpg" alt="Elden Ring"> <a class="game-link" href="game.html?game=EldenRing">Elden Ring</a> <span class="hours">75 hrs</span></li>
          <li><span class="rank">3</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/2748-144x192.jpg" alt="Minecraft"> <a class="game-link" href="game.html?game=Minecraft">Minecraft</a> <span class="hours">60 hrs</span></li>
          <li><span class="rank">4</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/33214-144x192.jpg" alt="DOOM"> <a class="game-link" href="game.html?game=DOOM">DOOM</a> <span class="hours">55 hrs</span></li>
          <li><span class="rank">5</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/493057-144x192.jpg" alt="Portal"> <a class="game-link" href="game.html?game=Portal">Portal</a> <span class="hours">50 hrs</span></li>
        </ol>
      </div>
      <div class="tab-content" id="popular-monthly" style="display:none;">
        <ol class="popular-games-list">
          <li><span class="rank">1</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/516575-144x192.jpg" alt="Elden Ring"> <a class="game-link" href="game.html?game=EldenRing">Elden Ring</a> <span class="hours">320 hrs</span></li>
          <li><span class="rank">2</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/27471-144x192.jpg" alt="Stardew Valley"> <a class="game-link" href="game.html?game=StardewValley">Stardew Valley</a> <span class="hours">290 hrs</span></li>
          <li><span class="rank">3</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/2748-144x192.jpg" alt="Minecraft"> <a class="game-link" href="game.html?game=Minecraft">Minecraft</a> <span class="hours">250 hrs</span></li>
          <li><span class="rank">4</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/33214-144x192.jpg" alt="DOOM"> <a class="game-link" href="game.html?game=DOOM">DOOM</a> <span class="hours">200 hrs</span></li>
          <li><span class="rank">5</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/493057-144x192.jpg" alt="Portal"> <a class="game-link" href="game.html?game=Portal">Portal</a> <span class="hours">180 hrs</span></li>
        </ol>
      </div>
      <div class="tab-content" id="popular-alltime" style="display:none;">
        <ol class="popular-games-list">
          <li><span class="rank">1</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/2748-144x192.jpg" alt="Minecraft"> <a class="game-link" href="game.html?game=Minecraft">Minecraft</a> <span class="hours">5,000 hrs</span></li>
          <li><span class="rank">2</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/516575-144x192.jpg" alt="Elden Ring"> <a class="game-link" href="game.html?game=EldenRing">Elden Ring</a> <span class="hours">4,200 hrs</span></li>
          <li><span class="rank">3</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/27471-144x192.jpg" alt="Stardew Valley"> <a class="game-link" href="game.html?game=StardewValley">Stardew Valley</a> <span class="hours">4,100 hrs</span></li>
          <li><span class="rank">4</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/33214-144x192.jpg" alt="DOOM"> <a class="game-link" href="game.html?game=DOOM">DOOM</a> <span class="hours">3,900 hrs</span></li>
          <li><span class="rank">5</span> <img class="game-cover-sm" src="https://static-cdn.jtvnw.net/ttv-boxart/493057-144x192.jpg" alt="Portal"> <a class="game-link" href="game.html?game=Portal">Portal</a> <span class="hours">3,500 hrs</span></li>
        </ol>
      </div>
    </section>
    <section class="activity card activity-wide">
      <h2><i class="fas fa-gamepad"></i> Recent Activity</h2>
      <button class="carousel-arrow left" aria-label="Scroll left"><i class="fas fa-chevron-left"></i></button>
      <div class="activity-carousel">
        <div class="loading-spinner">
          <i class="fas fa-spinner fa-spin"></i> Loading recent activity...
        </div>
      </div>
      <button class="carousel-arrow right" aria-label="Scroll right"><i class="fas fa-chevron-right"></i></button>
    </section>
    <section class="bonuses card bonuses-bottom">
      <h2><i class="fas fa-gift"></i> Recent Bonuses</h2>
      <div class="loading-spinner">
        <i class="fas fa-spinner fa-spin"></i> Loading recent bonuses...
      </div>
    </section>
  </main>
  <footer>
    <p>Inspired by backloggd & letterboxd. Not affiliated with Discord.</p>
  </footer>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Existing tab switching logic
      const tabContainers = document.querySelectorAll('.leaderboard-tabs, .popular-tabs');

      tabContainers.forEach(container => {
          const tabButtons = container.querySelectorAll('.tab-btn');
          // Find the content container for this set of tabs
          const contentContainer = container.nextElementSibling; // Assuming content immediately follows the buttons

          tabButtons.forEach(button => {
              button.addEventListener('click', function() {
                  const tabId = this.getAttribute('data-tab');
                  const parentSection = this.closest('section'); // Get the parent section

                  // Determine which section this tab belongs to and fetch data accordingly
                  if (parentSection.classList.contains('leaderboard')) {
                      // Leaderboard tabs
                      const timeframe = tabId; // Tab ID is the timeframe directly (weekly, monthly, alltime)
                       // Deactivate all buttons in this container
                      container.querySelectorAll('.tab-btn').forEach(btn => {
                          btn.classList.remove('active');
                      });
                       // Activate the clicked button
                      this.classList.add('active');

                       // Hide all content divs in this section and show the selected one
                       parentSection.querySelectorAll('.tab-content').forEach(content => {
                           content.style.display = 'none';
                       });
                       document.getElementById(tabId).style.display = 'block';

                       fetchLeaderboardData(timeframe); // Fetch data on click

                  } else if (parentSection.classList.contains('most-popular')) {
                      // Most Popular tabs
                      // Extract timeframe from tab ID (e.g., 'popular-weekly' -> 'weekly')
                      const timeframe = tabId.replace('popular-', '');

                       // Deactivate all buttons in this container
                      container.querySelectorAll('.tab-btn').forEach(btn => {
                          btn.classList.remove('active');
                      });
                       // Activate the clicked button
                      this.classList.add('active');

                       // Hide all content divs in this section and show the selected one
                       parentSection.querySelectorAll('.tab-content').forEach(content => {
                           content.style.display = 'none';
                       });
                       document.getElementById(tabId).style.display = 'block';

                       fetchPopularGames(timeframe); // Fetch data on click
                  }
              });
          });
      });

      // Initial display of active tabs
       document.querySelectorAll('.tab-content').forEach(content => {
           content.style.display = 'none';
       });
      document.querySelectorAll('.tab-btn.active').forEach(activeButton => {
          const tabId = activeButton.getAttribute('data-tab');
          const tabContent = document.getElementById(tabId);
          if (tabContent) {
              tabContent.style.display = 'block';
              // Trigger initial fetch for the active tabs
              if (activeButton.closest('.leaderboard-tabs')) {
                  fetchLeaderboardData(tabId);
              } else if (activeButton.closest('.popular-tabs')) {
                  // Extract timeframe from popular tab ID (e.g., 'popular-weekly' -> 'weekly')
                  const timeframe = tabId.replace('popular-', '');
                  fetchPopularGames(timeframe);
              }
          }
      });

      // Function to fetch and display leaderboard data for a specific timeframe
      // Helper function to format numbers with commas
      function formatNumberWithCommas(number) {
         return number.toLocaleString();
      }

      // Function to show loading state
      function setLoadingState(element, isLoading) {
        if (isLoading) {
          element.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading...</div>';
        }
      }

      // Function to create loading placeholders
      function createLoadingPlaceholders(count) {
        const placeholders = [];
        for (let i = 0; i < count; i++) {
          const placeholder = document.createElement('li');
          placeholder.className = 'loading-placeholder';
          placeholder.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Loading...`;
          placeholders.push(placeholder);
        }
        return placeholders;
      }

      function fetchPopularGames(timeframe) {
        const popularList = document.querySelector(`#popular-${timeframe} ol`);
        if (!popularList) return;

        // Show loading state
        popularList.innerHTML = '';
        const loadingPlaceholders = createLoadingPlaceholders(5);
        loadingPlaceholders.forEach(placeholder => popularList.appendChild(placeholder));

        fetch(`/api/popular-games?timeframe=${timeframe}`)
          .then(response => response.json())
          .then(data => {
            popularList.innerHTML = ''; // Clear loading state

            if (data && data.length > 0) {
              data.forEach((game, index) => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                  <span class="rank">${index + 1}</span>
                  <img class="game-cover-sm" src="${game.box_art_url || 'https://static-cdn.jtvnw.net/ttv-boxart/loading_boxart.png'}" alt="${game.name}">
                  <a class="game-link" href="game.html?game=${encodeURIComponent(game.name)}">${game.name}</a>
                  <span class="hours">${formatNumberWithCommas(game.hours)} hrs</span>
                `;
                popularList.appendChild(listItem);
              });
            } else {
              popularList.innerHTML = '<li>No game data available.</li>';
            }
          })
          .catch(error => {
            console.error(`Error fetching ${timeframe} popular games data:`, error);
            popularList.innerHTML = '<li>Error loading game data.</li>';
          });
      }

      function fetchLeaderboardData(timeframe) {
        console.log(`DEBUG: fetchLeaderboardData called for timeframe: ${timeframe}`); // Debug print
        const leaderboardList = document.querySelector(`#${timeframe} ol`);
        if (!leaderboardList) return;

        // Show loading state
        leaderboardList.innerHTML = '';
        const loadingPlaceholders = createLoadingPlaceholders(5);
        loadingPlaceholders.forEach(placeholder => leaderboardList.appendChild(placeholder));

        fetch(`/api/leaderboard?timeframe=${timeframe}`)
          .then(response => response.json())
          .then(data => {
            console.log(`DEBUG: Data received for ${timeframe} leaderboard:`, data); // Debug print
            leaderboardList.innerHTML = ''; // Clear loading state

            if (data.length > 0) {
              console.log(`DEBUG: Populating ${timeframe} leaderboard list with ${data.length} items.`); // Debug print
              data.slice(0, 5).forEach((player, index) => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                  <span class="rank">${index + 1}</span>
                  <img class="avatar" src="${player.avatar_url}" alt="${player.username}">
                  <a class="user-link" href="user.html?user=${player.user_id}">${player.username}</a>
                  <span class="score">${formatNumberWithCommas(player.points)} pts</span>
                `;
                leaderboardList.appendChild(listItem);
              });
            } else {
              leaderboardList.innerHTML = '<li>No leaderboard data available.</li>';
            }
          })
          .catch(error => {
            console.error(`Error fetching ${timeframe} leaderboard data:`, error);
            leaderboardList.innerHTML = '<li>Error loading leaderboard data.</li>';
          });
      }

      // Fetch data for all timeframes on page load
      fetchLeaderboardData('weekly');
      fetchLeaderboardData('monthly');
      fetchLeaderboardData('alltime');
      fetchPopularGames('weekly');
      fetchPopularGames('monthly');
      fetchPopularGames('alltime');

      // The tab button event listeners are now handled by the loop over tabContainers

    });

    // Function to fetch recent activity data and populate the carousel
    async function fetchRecentActivity() {
        try {
            const response = await fetch('/api/recent-activity');
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const recentActivity = await response.json();
            console.log('Recent Activity:', recentActivity); // Debugging

            const activityCarousel = document.querySelector('.activity-carousel');
            if (!activityCarousel) {
                console.error('Activity carousel element not found.');
                return;
            }

            // Show loading state
            activityCarousel.innerHTML = '';
            for (let i = 0; i < 5; i++) {
                const loadingCard = document.createElement('div');
                loadingCard.className = 'activity-card-wrap';
                loadingCard.innerHTML = `
                    <div class="activity-card loading">
                        <div class="activity-overlay loading">
                            <div class="activity-userblock">
                                <span class="activity-sessions">Loading...</span>
                                <span class="activity-time">Loading...</span>
                            </div>
                        </div>
                    </div>
                `;
                activityCarousel.appendChild(loadingCard);
            }

            // If there are no sessions fetched from the DB, show message
            if (!recentActivity || recentActivity.length === 0) {
                activityCarousel.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> No recent activity found</div>';
                return;
            }

            // Clear loading state and add actual content
            activityCarousel.innerHTML = '';
            recentActivity.forEach(session => {
                const cardWrap = document.createElement('div');
                cardWrap.className = 'activity-card-wrap';
                
                // Format timestamp for better display
                const timestamp = new Date(session.timestamp);
                const timeDisplay = timestamp.toLocaleDateString() + ' ' + timestamp.toLocaleTimeString();
                
                cardWrap.innerHTML = `
                    <div class="activity-card">
                        <a href="game.html?game=${encodeURIComponent(session.game_name)}">
                            <img class="game-cover-carousel" src="${session.box_art_url || 'https://static-cdn.jtvnw.net/ttv-boxart/loading_boxart.png'}" alt="${session.game_name}">
                        </a>
                        <div class="activity-date">${new Date(session.timestamp).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</div>
                        <div class="activity-overlay">
                            <img class="activity-avatar" src="${session.avatar_url}" alt="${session.username}">
                            <div class="activity-userblock">
                                <span class="activity-player"><a class="user-link" href="user.html?user=${session.user_id}">${session.username}</a></span>
                                <span class="activity-hours">${formatHours(session.hours)}</span>
                            </div>
                        </div>
                    </div>
                `;
                activityCarousel.appendChild(cardWrap);
            });

        } catch (error) {
            console.error('Error fetching recent activity:', error);
            const activityCarousel = document.querySelector('.activity-carousel');
            if (activityCarousel) {
                activityCarousel.innerHTML = '<div class="loading-spinner"><i class="fas fa-exclamation-circle"></i> Error loading recent activity</div>';
            }
        }
    }

    // Function to fetch recent bonus data and populate the list
    async function fetchRecentBonuses() {
        try {
            const response = await fetch('/api/recent-bonuses');
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const recentBonuses = await response.json();
            console.log('Recent Bonuses:', recentBonuses); // Debugging

            const bonusesList = document.querySelector('.bonuses ul');
            if (!bonusesList) {
                console.error('Recent bonuses list element not found.');
                return;
            }

            bonusesList.innerHTML = ''; // Clear existing content

            if (recentBonuses.length === 0) {
                bonusesList.innerHTML = '<li>No recent bonuses found.</li>';
                return;
            }

            // Create list items for each bonus
            recentBonuses.forEach(bonus => {
                const listItem = document.createElement('li');
                
                // Format the credits amount
                const formattedCredits = formatNumberWithCommas(bonus.credits);

                listItem.innerHTML = `
                    <img class="avatar-sm" src="${bonus.avatar_url}" alt="${bonus.username}">
                    <a class="user-link" href="user.html?user=${bonus.user_id}">${bonus.username}</a>
                    earned <span class="bonus-amount">${formattedCredits} cred</span> for "${bonus.reason}"
                `;

                bonusesList.appendChild(listItem);
            });

        } catch (error) {
            console.error('Error fetching recent bonuses:', error);
            const bonusesList = document.querySelector('.bonuses ul');
            if (bonusesList) {
                bonusesList.innerHTML = '<li>Error loading recent bonuses.</li>';
            }
        }
    }

    // Call fetchRecentActivity and fetchRecentBonuses when the page loads
    document.addEventListener('DOMContentLoaded', () => {
        fetchRecentActivity();
        fetchRecentBonuses(); // Call the new function
        // Initialize carousel functionality after fetching data
        setupActivityCarousel();
    });

    // Helper function to format numbers with commas (if needed elsewhere)
    function formatNumberWithCommas(number) {
        return number.toLocaleString();
    }

    // Function to set up the activity carousel scrolling
    function setupActivityCarousel() {
        const activityCarousel = document.querySelector('.activity-carousel');
        const leftArrow = document.querySelector('.activity-wide .carousel-arrow.left');
        const rightArrow = document.querySelector('.activity-wide .carousel-arrow.right');

        if (!activityCarousel || !leftArrow || !rightArrow) {
            console.error('Activity carousel elements not found for scrolling setup.');
            return;
        }

        const scrollAmount = 300; // Adjust scroll amount as needed

        leftArrow.addEventListener('click', () => {
            activityCarousel.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
        });

        rightArrow.addEventListener('click', () => {
            activityCarousel.scrollBy({ left: scrollAmount, behavior: 'smooth' });
        });

        // Optional: Add logic to hide/show arrows based on scroll position
        // This is more complex and might be added later if needed.
    }

    // Add this helper function near the other formatting functions
    function formatHours(hours) {
        const wholeHours = Math.floor(hours);
        const minutes = Math.round((hours - wholeHours) * 60);
        let timeDisplay = '';
        if (wholeHours > 0) {
            timeDisplay += `${wholeHours}h `;
        }
        if (minutes > 0 || wholeHours === 0) {
            timeDisplay += `${minutes}m`;
        }
        return timeDisplay;
    }
  </script>
</body>
<script src="script.js"></script>
</html> 